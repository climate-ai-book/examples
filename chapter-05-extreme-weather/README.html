<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 5: Extreme Weather Event Prediction</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
            background-color: #ffffff;
        }
        h1 {
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
            font-size: 2em;
            margin-bottom: 16px;
        }
        h2 {
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
            font-size: 1.5em;
            margin-top: 24px;
            margin-bottom: 16px;
        }
        h3 {
            font-size: 1.25em;
            margin-top: 24px;
            margin-bottom: 16px;
        }
        h4 {
            font-size: 1em;
            margin-top: 24px;
            margin-bottom: 16px;
        }
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        pre {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
        }
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        ul, ol {
            padding-left: 2em;
            margin-top: 0;
            margin-bottom: 16px;
        }
        li {
            margin-bottom: 0.25em;
        }
        a {
            color: #0366d6;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        hr {
            height: 0.25em;
            padding: 0;
            margin: 24px 0;
            background-color: #e1e4e8;
            border: 0;
        }
    </style>
</head>
<body>
<h1>Chapter 5: Extreme Weather Event Prediction</h1>
<p>This folder contains code examples, notebooks, and datasets accompanying Chapter 5 of "AI in Climate Science: Machine Learning for Environmental Modeling and Prediction."</p>
<h2>Chapter Overview</h2>
<p>This chapter develops comprehensive mathematical frameworks for AI-enhanced extreme weather prediction, including:</p>
<ul>
<li>Mathematical foundations of extreme weather prediction</li>
<li>Deep learning architectures for extreme event detection</li>
<li>Physics-informed neural networks for extreme weather dynamics</li>
<li>Advanced ensemble methods for rare event uncertainty quantification</li>
<li>Spectral analysis and multi-scale extreme weather modeling</li>
<li>Advanced optimization techniques for imbalanced datasets</li>
<li>Probabilistic forecasting and extreme value analysis</li>
<li>Real-time processing and operational deployment</li>
<li>Advanced evaluation frameworks for extreme weather models</li>
</ul>
<h2>Contents</h2>
<pre><code>chapter-05-extreme-weather/
├── README.html (this file)
├── notebooks/
│   ├── 01_extreme_value_theory.ipynb
│   ├── 02_imbalanced_learning_extreme_events.ipynb
│   ├── 03_attention_mechanisms_extremes.ipynb
│   ├── 04_rare_event_ensemble_methods.ipynb
│   ├── 05_multi_scale_extreme_detection.ipynb
│   ├── 06_probabilistic_extreme_forecasting.ipynb
│   └── 07_operational_warning_systems.ipynb
├── scripts/
│   ├── extreme_weather_framework.py
│   ├── evt_neural_networks.py
│   ├── focal_loss_training.py
│   └── extreme_event_verification.py
└── data/
    ├── extreme_events_catalog.csv
    ├── hurricane_tracks.nc
    └── README.md
</code></pre>
<h2>Key Concepts and Mathematical Foundations</h2>
<h3>1. Extreme Value Theory</h3>
<p><strong>Generalized Extreme Value (GEV) Distribution:</strong></p>
<pre><code>F(x;μ,σ,ξ) = exp{-[1 + ξ(x-μ)/σ]^{-1/ξ}}
ξ > 0: Fréchet domain (heavy tails)
ξ = 0: Gumbel domain (exponential tails)
ξ < 0: Weibull domain (bounded)</code></pre>
<p><strong>Generalized Pareto Distribution (GPD):</strong></p>
<pre><code>F(x;σ,ξ) = 1 - (1 + ξx/σ)^{-1/ξ}</code></pre>
<p><strong>Return Level:</strong></p>
<pre><code>x_T = μ + (σ/ξ)[(-ln(1-1/T))^{-ξ} - 1]</code></pre>
<h3>2. Lyapunov Exponent and Predictability</h3>
<p><strong>Divergence Rate:</strong></p>
<pre><code>λ = lim_{t→∞} (1/t)ln(|δ(t)|/|δ(0)|)</code></pre>
<p><strong>Predictability Timescale:</strong></p>
<pre><code>τ_pred = (1/λ)ln(Δ_saturation/Δ_initial)</code></pre>
<h3>3. Extreme Value Loss Function</h3>
<pre><code>L_extreme = L_mse + λ_tail L_tail + λ_evt L_evt</code></pre>
<h3>4. Deep Learning for Extremes</h3>
<p><strong>Scale-Adaptive Convolution:</strong></p>
<pre><code>(X *_adaptive W)_{i,j} = Σ_{m,n} X_{i+d_m·m, j+d_n·n} · W_{m,n}</code></pre>
<p><strong>Extreme-Aware Attention:</strong></p>
<pre><code>Attention_extreme(Q,K,V) = softmax(QK^T/√d_k + βE_extreme)V</code></pre>
<p><strong>Extreme-LSTM Gates:</strong></p>
<pre><code>f_t = σ(W_f·[h_{t-1},x_t] + b_f + γ_f I_extreme)
i_t = σ(W_i·[h_{t-1},x_t] + b_i + γ_i I_extreme)
o_t = σ(W_o·[h_{t-1},x_t] + b_o + γ_o I_extreme)</code></pre>
<h3>5. Physics-Informed Constraints</h3>
<p><strong>CAPE (Convective Available Potential Energy):</strong></p>
<pre><code>CAPE = g ∫_{z_LFC}^{z_EL} (T_{v,parcel} - T_{v,env})/T_{v,env} dz</code></pre>
<p><strong>Obukhov Length:</strong></p>
<pre><code>L = -u_*³ T_v/(κg w'θ_v')</code></pre>
<p><strong>PINN Loss for Extremes:</strong></p>
<pre><code>L_PINN-extreme = L_data + λ_pde L_pde + λ_bc L_bc + λ_conserve L_conserve + λ_extreme L_extreme</code></pre>
<h3>6. Ensemble Methods for Rare Events</h3>
<p><strong>Enhanced Perturbation Scaling:</strong></p>
<pre><code>σ_pert^extreme = σ_pert^standard · (1 + α_extreme · max(0, I_extreme - I_threshold))</code></pre>
<p><strong>Importance Sampling:</strong></p>
<pre><code>P̂_extreme = (1/N)Σ I(X_i∈A) p(X_i)/q(X_i)</code></pre>
<p><strong>Bayesian Model Averaging:</strong></p>
<pre><code>p(y*|x*,D) = Σ_k p(y*|x*,M_k,D) p(M_k|D)</code></pre>
<h3>7. Optimization for Imbalanced Data</h3>
<p><strong>Focal Loss:</strong></p>
<pre><code>L_focal(p_t) = -α_t(1-p_t)^γ log(p_t)</code></pre>
<p><strong>Adam with Momentum:</strong></p>
<pre><code>v_{t+1} = β₁v_t + (1-β₁)∇L
s_{t+1} = β₂s_t + (1-β₂)(∇L)²
θ_{t+1} = θ_t - η/(√s_{t+1} + ε) ⊙ v_{t+1}</code></pre>
<h3>8. Probabilistic Forecasting</h3>
<p><strong>Bayesian Posterior:</strong></p>
<pre><code>p(θ|D_extreme) ∝ p(D_extreme|θ) p(θ)</code></pre>
<p><strong>Evidence Lower Bound (ELBO):</strong></p>
<pre><code>L_ELBO = E_{q_φ(θ)}[log p(D_extreme|θ)] - KL[q_φ(θ)||p(θ)]</code></pre>
<p><strong>Conformal Prediction:</strong></p>
<pre><code>C(x) = {y : s(x,y) ≤ Q_{1-α}({s(x_i,y_i)})}</code></pre>
<h3>9. Evaluation Metrics</h3>
<p><strong>ROC Metrics:</strong></p>
<pre><code>TPR(τ) = TP/(TP + FN)
FPR(τ) = FP/(FP + TN)</code></pre>
<p><strong>Precision-Recall:</strong></p>
<pre><code>Precision = TP/(TP + FP)
Recall = TP/(TP + FN)
F1 = 2·Precision·Recall/(Precision + Recall)</code></pre>
<p><strong>Extreme Dependency Score:</strong></p>
<pre><code>EDS = 2log(F_o(p))/log(F_{f,o}(p,p)) - 1</code></pre>
<p><strong>Economic Value Score:</strong></p>
<pre><code>EVS = (H - F·C/L)/(1-s) - C/L</code></pre>
<h2>Running the Examples</h2>
<h3>Prerequisites</h3>
<pre><code>pip install numpy pandas scipy xarray netCDF4 tensorflow torch matplotlib scikit-learn imbalanced-learn</code></pre>
<h3>Jupyter Notebooks</h3>
<pre><code>cd chapter-05-extreme-weather/notebooks
jupyter lab</code></pre>
<h3>Python Scripts</h3>
<pre><code>cd chapter-05-extreme-weather/scripts
python extreme_weather_framework.py</code></pre>
<h2>Notebook Descriptions</h2>
<h3>01_extreme_value_theory.ipynb</h3>
<ul>
<li>GEV and GPD fitting</li>
<li>Return level calculation</li>
<li>Tail behavior analysis</li>
<li>Block maxima and peaks-over-threshold methods</li>
</ul>
<h3>02_imbalanced_learning_extreme_events.ipynb</h3>
<ul>
<li>Focal loss implementation</li>
<li>SMOTE for rare events</li>
<li>Class weighting strategies</li>
<li>Evaluation metrics for imbalanced data</li>
</ul>
<h3>03_attention_mechanisms_extremes.ipynb</h3>
<ul>
<li>Extreme-aware attention</li>
<li>Teleconnection detection</li>
<li>Multi-head attention for scale interactions</li>
<li>Spatial attention for hazard localization</li>
</ul>
<h3>04_rare_event_ensemble_methods.ipynb</h3>
<ul>
<li>Enhanced perturbation strategies</li>
<li>Importance sampling</li>
<li>Multilevel Monte Carlo</li>
<li>Bayesian model averaging</li>
</ul>
<h3>05_multi_scale_extreme_detection.ipynb</h3>
<ul>
<li>Wavelet decomposition</li>
<li>Scale-adaptive convolutions</li>
<li>Energy cascade analysis</li>
<li>Multi-resolution neural networks</li>
</ul>
<h3>06_probabilistic_extreme_forecasting.ipynb</h3>
<ul>
<li>Bayesian neural networks</li>
<li>Conformal prediction</li>
<li>Quantile regression</li>
<li>Uncertainty calibration</li>
</ul>
<h3>07_operational_warning_systems.ipynb</h3>
<ul>
<li>Real-time data processing</li>
<li>Alert generation algorithms</li>
<li>Performance under operational constraints</li>
<li>Decision support systems</li>
</ul>
<h2>Extreme Event Types Covered</h2>
<h3>Tropical Cyclones</h3>
<ul>
<li>Track prediction</li>
<li>Intensity forecasting</li>
<li>Rapid intensification detection</li>
<li>Landfall timing</li>
</ul>
<h3>Severe Convective Storms</h3>
<ul>
<li>Tornado prediction</li>
<li>Hail forecasting</li>
<li>Damaging wind events</li>
<li>Flash flood warnings</li>
</ul>
<h3>Heat Waves</h3>
<ul>
<li>Duration prediction</li>
<li>Spatial extent forecasting</li>
<li>Health impact assessment</li>
<li>Urban heat island effects</li>
</ul>
<h3>Extreme Precipitation</h3>
<ul>
<li>Flash flood prediction</li>
<li>Heavy rainfall forecasting</li>
<li>Atmospheric river detection</li>
<li>Orographic enhancement</li>
</ul>
<h2>Performance Metrics</h2>
<h3>Classification Metrics</h3>
<ul>
<li><strong>Accuracy:</strong> Overall correctness</li>
<li><strong>Precision:</strong> Positive predictive value</li>
<li><strong>Recall (Sensitivity):</strong> True positive rate</li>
<li><strong>F1 Score:</strong> Harmonic mean of precision/recall</li>
<li><strong>AUC-ROC:</strong> Area under ROC curve</li>
<li><strong>AUC-PR:</strong> Area under precision-recall curve</li>
</ul>
<h3>Probabilistic Metrics</h3>
<ul>
<li><strong>Brier Score:</strong> Probability forecast accuracy</li>
<li><strong>Reliability Diagram:</strong> Calibration assessment</li>
<li><strong>CRPS:</strong> Continuous ranked probability score</li>
</ul>
<h3>Extreme-Specific Metrics</h3>
<ul>
<li><strong>EDS:</strong> Extreme dependency score</li>
<li><strong>EVS:</strong> Economic value score</li>
<li><strong>POD:</strong> Probability of detection</li>
<li><strong>FAR:</strong> False alarm ratio</li>
<li><strong>CSI:</strong> Critical success index</li>
</ul>
<h2>Applications</h2>
<h3>Early Warning Systems</h3>
<ul>
<li>Multi-hazard monitoring</li>
<li>Alert dissemination</li>
<li>Impact-based forecasting</li>
<li>Decision support</li>
</ul>
<h3>Risk Assessment</h3>
<ul>
<li>Return period estimation</li>
<li>Vulnerability mapping</li>
<li>Climate change impacts</li>
<li>Infrastructure planning</li>
</ul>
<h3>Emergency Management</h3>
<ul>
<li>Resource allocation</li>
<li>Evacuation planning</li>
<li>Damage assessment</li>
<li>Recovery optimization</li>
</ul>
<h2>Further Reading</h2>
<ul>
<li>Full chapter text in the book</li>
<li>Additional tutorials: <a href="https://climate-ai-book.readthedocs.io">https://climate-ai-book.readthedocs.io</a></li>
<li>Discussion forum: <a href="https://github.com/climate-ai-book/examples/discussions">https://github.com/climate-ai-book/examples/discussions</a></li>
</ul>
<h2>Contributing</h2>
<p>Found an error or have an improvement? Please open an issue or submit a pull request.</p>
<h2>License</h2>
<p>MIT License - See main repository LICENSE file</p>
<h2>Contact</h2>
<ul>
<li>GitHub Issues: <a href="https://github.com/climate-ai-book/examples/issues">https://github.com/climate-ai-book/examples/issues</a></li>
<li>Email: <a href="mailto:contact@climate-ai-book.org">contact@climate-ai-book.org</a></li>
</ul>
<hr>
<p><em>Part of "AI in Climate Science: Machine Learning for Environmental Modeling and Prediction"<br>
by Gupta, Kanwer, and Ahmad (2025)</em></p>
</body>
</html>
